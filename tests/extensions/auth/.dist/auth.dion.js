//{"id":"auth","name":"auth","url":"www.example.com","icon":"www.example.com/icon.png","lang":[],"nsfw":false,"media_type":["Book"],"extension_type":[],"version":"1.0.0","license":"ISC","api_version":"*","repo":"string"}
import{fetch as n}from"network";import{getSetting as u}from"setting";class o{async validate(t){return t}async onEvent(t){switch(t.type){case"Action":return;case"FeedUpdate":return{type:t.type,customui:[],hasnext:null,length:null};case"SwapContent":return{type:t.type,customui:{type:"Text",text:"asd"}}}}async mapSource(t,e,r){return{source:t,settings:r}}async mapEntry(t,e){return{entry:t,settings:e}}async onEntryActivity(t,e,r){}async browse(t){let e=await s();return{content:(await n(`${e}/getEntries`)).json}}async search(t,e){let r=await s();return{content:(await n(`${r}/getEntries`)).json}}async handleUrl(t){return!0}async detail(t,e){let r=await s();return{entry:(await n(`${r}/getEntry`)).json,settings:e}}async source(t,e){let r=await s();return{source:(await n(`${r}/getSource`)).json,settings:e}}}async function s(){let t=await u("testdataserver","Extension"),e=t.value.data;if(t.value.type!=="String")throw Error("Failed to get Server");if(e.endsWith("/"))return e.substring(0,e.length-1);return e}import{mergeAuth as i,isLoggedIn as c,getAuthSecret as y,invalidate as d}from"auth";class p extends o{async load(){await i({domain:"example.com",auth:{type:"UserPass"}}),await i({domain:"api.example.com",auth:{type:"ApiKey"}}),await i({domain:"cookie.example.com",auth:{type:"Cookie",loginpage:"https://cookie.example.com/login",logonpage:"https://cookie.example.com/dashboard"}});let t=await c("example.com");console.log("Is logged in:",t),await d("example.com");let e=!1;try{await y("example.com"),e=!0}catch(r){}if(e)throw new Error("get_auth_secret did not throw for unauthenticated account")}}export{p as default};
