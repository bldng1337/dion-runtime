//{"id":"permissions","name":"permissions","url":"www.example.com","icon":"www.example.com/icon.png","lang":[],"nsfw":false,"media_type":["Book"],"extension_type":[],"version":"1.0.0","license":"ISC","api_version":"*","repo":"string"}
import{fetch as o}from"network";import{getSetting as y}from"setting";class s{async validate(t){return t}async onEvent(t){switch(t.type){case"Action":return;case"FeedUpdate":return{type:t.type,customui:[],hasnext:null,length:null};case"SwapContent":return{type:t.type,customui:{type:"Text",text:"asd"}}}}async mapSource(t,e,n){return{source:t,settings:n}}async mapEntry(t,e){return{entry:t,settings:e}}async onEntryActivity(t,e,n){}async browse(t){let e=await i();return{content:(await o(`${e}/getEntries`)).json}}async search(t,e){let n=await i();return{content:(await o(`${n}/getEntries`)).json}}async handleUrl(t){return!0}async detail(t,e){let n=await i();return{entry:(await o(`${n}/getEntry`)).json,settings:e}}async source(t,e){let n=await i();return{source:(await o(`${n}/getSource`)).json,settings:e}}}async function i(){let t=await y("testdataserver","Extension"),e=t.value.data;if(t.value.type!=="String")throw Error("Failed to get Server");if(e.endsWith("/"))return e.substring(0,e.length-1);return e}function r(t,e="Extension error"){if(!t)throw Error(`Assert failed: ${e}`)}import{hasPermission as u,requestPermission as c}from"permission";class S extends s{async load(){{let t={type:"Storage",path:"some",write:!1},e=await c(t,"some permission");r(e===!0,"permission was not granted"),r(await u(t)===!0,"permission is not granted even though it was granted before")}{let t={type:"Storage",path:"other",write:!0},e=await c(t,"deny");r(e===!1,"permission was granted"),r(await u(t)===!1,"permission is granted even though it was denied before")}}}export{S as default};
