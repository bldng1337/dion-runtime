//{"id":"settings","name":"settings","url":"www.example.com","icon":"www.example.com/icon.png","lang":[],"nsfw":false,"media_type":["Book"],"extension_type":[],"version":"1.0.0","license":"ISC","api_version":"*","repo":"string"}
import{fetch as s}from"network";import{getSetting as E}from"setting";class c{async validate(t){return t}async onEvent(t){switch(t.type){case"Action":return;case"FeedUpdate":return{type:t.type,customui:[],hasnext:null,length:null};case"SwapContent":return{type:t.type,customui:{type:"Text",text:"asd"}}}}async mapSource(t,e,r){return{source:t,settings:r}}async mapEntry(t,e){return{entry:t,settings:e}}async onEntryActivity(t,e,r){}async browse(t){let e=await i();return{content:(await s(`${e}/getEntries`)).json}}async search(t,e){let r=await i();return{content:(await s(`${r}/getEntries`)).json}}async handleUrl(t){return!0}async detail(t,e){let r=await i();return{entry:(await s(`${r}/getEntry`)).json,settings:e}}async source(t,e){let r=await i();return{source:(await s(`${r}/getSource`)).json,settings:e}}}async function i(){let t=await E("testdataserver","Extension"),e=t.value.data;if(t.value.type!=="String")throw Error("Failed to get Server");if(e.endsWith("/"))return e.substring(0,e.length-1);return e}function y(t,e="Extension error"){if(!t)throw Error(`Assert failed: ${e}`)}function d(t,e,r="Assert"){let[n,o]=u(t,e);if(!n)throw Error(` ${r} failed: ${o}`)}function u(t,e,r=""){if(typeof t!==typeof e)return[!1,`Failed at ${r}. Expected ${typeof t} but got ${typeof e}`];if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return[!1,`Failed at ${r}. Expected array of length ${t.length} but got length ${e.length} 
expected: ${JSON.stringify(t)}
got: ${JSON.stringify(e)}`];for(let n=0;n<t.length;n++){let[o,a]=u(t[n],e[n],`${r}[${n}]`);if(!o)return[!1,a]}}else if(t instanceof Object&&e instanceof Object)for(let n of Object.keys(t)){let[o,a]=u(t[n],e[n],`${r}.${n}`);if(!o)return[!1,a]}else if(t!==e)return[!1,`Failed at ${r}. Expected ${t} but got ${e} 
expected: ${JSON.stringify(t)}
got: ${JSON.stringify(e)}`];return[!0,""]}import{getSetting as l,registerSetting as f}from"setting";class v extends c{async load(){let t={default:{type:"String",data:"somedefault"},value:{type:"String",data:"somevalue"},label:"SomeLabel",visible:!0};await f("someid",t,"Extension");let e=await l("someid","Extension");d(t,e,"setting should be equal to what was registered"),y(e.value.type==="String"&&e.value.data==="somevalue","Setting should be set to somevalue")}async browse(t){let e=await l("someid","Extension");return y(e.value.type==="String"&&e.value.data==="othervalue","Setting should be set to othervalue on the native side"),super.browse(t)}}export{v as default};
