//{"id":"settings","name":"settings","url":"www.example.com","icon":"www.example.com/icon.png","lang":[],"nsfw":false,"media_type":["Book"],"extension_type":[],"version":"1.0.0","license":"ISC","api_version":"*","repo":"string"}
import{fetch as s}from"network";import{getSetting as f}from"setting";class c{async onEvent(e){switch(e.type){case"Action":return;case"FeedUpdate":return{type:e.type,customui:[],hasnext:null,length:null};case"SwapContent":return{type:e.type,customui:{type:"Text",text:"asd"}}}}async mapSource(e,t,r){return{source:e,settings:r}}async mapEntry(e,t){return{entry:e,settings:t}}async onEntryActivity(e,t,r){}async browse(e){let t=await i();return{content:(await s(`${t}/getEntries`)).json}}async search(e,t){let r=await i();return{content:(await s(`${r}/getEntries`)).json}}async handleUrl(e){return!0}async detail(e,t){let r=await i();return{entry:(await s(`${r}/getEntry`)).json,settings:t}}async source(e,t){let r=await i();return{source:(await s(`${r}/getSource`)).json,settings:t}}}async function i(){let e=await f("testdataserver","Extension"),t=e.value.data;if(e.value.type!=="String")throw Error("Failed to get Server");if(t.endsWith("/"))return t.substring(0,t.length-1);return t}function y(e,t="Extension error"){if(!e)throw new Error(`Assert failed: ${t}`)}function d(e,t,r="Assert"){let[n,o]=u(e,t);if(!n)throw new Error(` ${r} failed: ${o}`)}function u(e,t,r=""){if(typeof e!==typeof t)return[!1,`Failed at ${r}. Expected ${typeof e} but got ${typeof t}`];if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return[!1,`Failed at ${r}. Expected array of length ${e.length} but got length ${t.length} 
expected: ${JSON.stringify(e)}
got: ${JSON.stringify(t)}`];for(let n=0;n<e.length;n++){let[o,a]=u(e[n],t[n],`${r}[${n}]`);if(!o)return[!1,a]}}else if(e instanceof Object&&t instanceof Object)for(let n of Object.keys(e)){let[o,a]=u(e[n],t[n],`${r}.${n}`);if(!o)return[!1,a]}else if(e!==t)return[!1,`Failed at ${r}. Expected ${e} but got ${t} 
expected: ${JSON.stringify(e)}
got: ${JSON.stringify(t)}`];return[!0,""]}import{getSetting as l,registerSetting as E}from"setting";class v extends c{async load(){let e={default:{type:"String",data:"somedefault"},value:{type:"String",data:"somevalue"},label:"SomeLabel",visible:!0};await E("someid",e,"Extension");let t=await l("someid","Extension");d(e,t,"setting should be equal to what was registered"),y(t.value.type==="String"&&t.value.data==="somevalue","Setting should be set to somevalue")}async browse(e){let t=await l("someid","Extension");return y(t.value.type==="String"&&t.value.data==="othervalue","Setting should be set to othervalue on the native side"),super.browse(e)}}export{v as default};
